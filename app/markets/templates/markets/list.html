{% extends "base.html" %}

{% block head_title %}Search results | Selling online overseas{% endblock head_title %}

{% block head_meta_description %}Read and review the results. Compare, then select online marketplaces that are suitable for your products.{% endblock head_meta_description %}

{% load static utils %}

{% block head_js_ga360 %}
  {{ block.super }}
  <script src="{% static 'javascripts/dit.tagging.js' %}"></script>
  <script>
    window.dataLayer.push({ 'pageCategory': 'SearchResultsPage' });
    dit.tagging.soo.init('SearchResultsPage');
  </script>
{% endblock %}

{% block content %}
  <div class="outer-container push--top soft--top">
    <aside class="background--bright-grey-opacity soft-half autocomplete-aside modal" data-modal-id="search">
      <form id='results-form' method="get" action="{% url 'markets:list' %}" data-count-action='{% url "markets:count" %}' data-form-type="autocomplete">
        <fieldset>
          <a href="#" data-action="clear-fields" class="clear-all link">Clear all</a>
          <a href="#" data-action="close-modal" class="modal-close"><i class="icon icon-close--blue"></i></a>
          <div role="group" class="autocomplete-form-group">
            <legend class="h3 modal-header font-med soft-half--ends push--bottom">Search</legend>
            <div class="push--bottom">
              <div class="form-dropdown">
                <label class="form-label" for="search-product">What do you sell?
                  <span class="form-hint">Enter your product type and pick a category</span>
                </label>
                <input class="form-control form-control--full form-dropdown-input" id="search-product" type="text" data-url="{% url 'products:api' %}" data-field="product_categories" autocomplete="off" placeholder="Product type" aria-owns="search-product-dropdown">
                <ul class="form-dropdown-results" role="listbox" id="search-product-dropdown" aria-live="polite"></ul>
              </div>
            </div>
            <div class="push--bottom soft-half--top">
              <div class="form-dropdown">
                <label class="form-label" for="search-country">Where do you want to sell?
                  <span class="form-hint">Leave this empty if you are not sure</span>
                </label>
                <input class="form-control form-control--full form-dropdown-input" id="search-country" type="text" data-url="{% url 'geography:api' %}" data-field="operating_countries" autocomplete="off" placeholder="Country name" aria-owns="search-country-dropdown">
                <ul class="form-dropdown-results" role="listbox" aria-live="polite" id="search-country-dropdown"></ul>
                <ul class="form-dropdown-checkbox hide"></ul>
              </div>
            </div>
            <div class="cf autocomplete-tags">
              <ul class="form-dropdown-tags"></ul>
            </div>
            <div class="push--bottom soft-half--top">
              <div id='results-count' class="modal-button">
                <button class='button button-red button-medium button-full' type='submit'>Start your search now (<span class="results-count">{{results_count}}</span>)</button>
              </div>
            </div>
          </div>
        </fieldset>
        <div class="autocomplete-status" role="listbox" aria-live="polite"></div>
      </form>
    </aside>
    <div class="modal markets-sort" id="sort" data-modal-id="sorting">
      <form class="cf soft-half" method="get" action="{% url 'markets:list' %}">
        <a href="#" data-action="close-modal" class="modal-close"><i class="icon icon-close--blue"></i></a>
        <div class="form-group">
          <legend class="h3 modal-header font-med soft-half--ends push-half--bottom">Sort by</legend>
          <div class="soft--top">

    {% for market in markets_list %}
      <div class="market-item {% if market.has_special_terms %}has-special-terms{% endif %}">
        {% if market.has_special_terms %}
        <div class="special-terms-container">
          <div class="special-terms-summary">
            {% if market.dit_special_terms_summary %}
              <strong>SPECIAL DEAL &nbsp | &nbsp</strong> {{ market.dit_special_terms_summary }}
            {% else %}
              <strong>SPECIAL DEAL</strong>
            {% endif %}
          </div>

        </div>
      </form>
    </div>
    <div class="markets-list">
      <div class="markets-buttons push-half--bottom">
        <button class="button button-border" data-modal-button="search">Search<i class="icon icon-search" data-modal-button="search"></i></button>
        <button class="button button-border" data-modal-button="sorting">Sort<i class="icon icon-sort" data-modal-button="sorting"></i></button>
      </div>
      <div class="cf">
        <div class="markets-list-header">
          <h1 class="push--bottom"><span class="h3">{{ markets_list.count }}</span> <span class="font-reg">marketplace{{markets_list|pluralize}}</span>
            {% if markets_list.count == 0 %} match your search {% endif %}
          </h1>
        </div>
        {% endif %}
        <div class="market-item-inner">
          <img src="{% thumbnail market.logo.image 400x302 box=market.logo.cropping crop detail %}" class="market-item-img" alt="Navigate to full profile of {{ market.name }}" />
          <div class="market-item-body">
            <div class="add-to-compare markets-shortlist font-mid-blue" data-slug="{{ market.slug }}">
              Add to compare
            </div>
          </div>
          <div class="shortlist-items shortlist-items--short col-5">
            <a href="{% url 'markets:shortlist' %}">
              <dl class="float--right font-mid-blue">
                <dt class="float--left push-half--right link">Shortlist:</dt>
                <dd class="float--left"><strong class="shortlist-count"></strong><i class="icon icon-shortlisted float--right shortlist-icon"></i></dd>
              </dl>
            </a>
          </div>
        </div>
      </div>

      <ul class="markets" id="scroll-top">
        {% include "markets/includes/market_list.html" %}
      </ul>
      <a class="link link--top" data-scrollto="scroll-top">Go to top</a>
    </div>
  </div>

{% endblock content %}
